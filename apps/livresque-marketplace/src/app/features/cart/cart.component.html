<div class="relative flex min-h-screen w-full flex-col">
  <app-header></app-header>
  <main class="flex-1 py-12 lg:py-16 relative">
<div class="absolute inset-0 overflow-hidden pointer-events-none opacity-50">
<div class="absolute inset-0 bg-background-dark"></div>
<svg class="absolute -top-1/4 left-0 text-primary/5 w-1/2 h-1/2" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
<path d="M42.7,-72.2C55.3,-66.1,65.3,-55.3,73.1,-43.3C80.9,-31.3,86.5,-18.1,85.6,-5.3C84.7,7.5,77.3,19.9,68.6,30.8C59.9,41.7,49.9,51.1,38.6,58.8C27.3,66.5,14.7,72.5,0.7,71.3C-13.3,70.1,-25.6,61.7,-37.8,54.1C-50,46.5,-62.1,39.7,-70.6,29.3C-79.1,18.9,-84,4.9,-82.1,-8.1C-80.2,-21.1,-71.5,-33.1,-61.6,-42.6C-51.7,-52.1,-40.6,-59.1,-29.3,-66.1C-18,-73.1,-6.5,-80.1,5.2,-80.9C16.9,-81.7,30.1,-60.3,42.7,-72.2Z" fill="currentColor" transform="translate(100 100)"></path>
</svg>
<svg class="absolute bottom-0 right-0 text-surface-highlight/10 w-2/3 h-2/3" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
<path d="M47.1,-63.9C61.8,-53.5,74.9,-42.2,81.4,-28.4C87.9,-14.7,87.8,1.5,82.8,16.2C77.7,30.8,67.7,43.9,55.5,53.8C43.3,63.7,28.9,70.3,13.9,73.1C-1.1,75.9,-16.7,74.8,-30.4,68.9C-44.1,62.9,-55.8,52,-64.2,39.3C-72.6,26.6,-77.6,12.1,-76.3,-1.9C-75,-16,-67.4,-29.6,-56.9,-39.2C-46.3,-48.8,-32.8,-54.4,-19.6,-66C-6.4,-77.6,6.5,-95.2,18.8,-94.1C31.1,-93,42.8,-73.2,47.1,-63.9Z" fill="currentColor" transform="translate(100 100)"></path>
</svg>
</div>
<div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 relative z-10">
<div class="text-center mb-10">
<h1 class="text-4xl font-black tracking-tight text-white sm:text-5xl">Votre Panier</h1>
<p class="mt-4 text-lg text-gray-400">Finalisez votre commande et plongez dans de nouvelles lectures.</p>
</div>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8 xl:gap-12">
<div class="lg:col-span-2">
          <!-- Messages d'état du panier -->
          <div *ngIf="!(items$ | async) || (items$ | async)!.length === 0" class="text-center py-16">
            <div class="text-6xl text-gray-600 mb-4">🛒</div>
            <h3 class="text-xl font-semibold text-white mb-2">Votre panier est vide</h3>
            <p class="text-gray-400 mb-6">Découvrez nos livres et ajoutez-en à votre panier pour commencer vos lectures.</p>
            <a [routerLink]="['/shop']" class="inline-flex items-center gap-2 bg-primary text-background-dark px-6 py-3 rounded-lg font-semibold hover:bg-opacity-90 transition-all">
              <span class="material-symbols-outlined">storefront</span>
              Parcourir la boutique
            </a>
          </div>

          <!-- Liste des articles -->
          <div *ngIf="(items$ | async) && (items$ | async)!.length > 0" class="space-y-6">
            <div *ngFor="let item of items$ | async" class="bg-surface-dark/80 backdrop-blur-sm border border-surface-highlight rounded-xl p-4 sm:p-6 flex flex-col sm:flex-row items-start sm:items-center gap-6">
              <div class="w-full sm:w-24 flex-shrink-0">
                <div class="aspect-[2/3] rounded-md overflow-hidden bg-surface-highlight">
                  <img [alt]="'Couverture de ' + item.title" class="w-full h-full object-cover" [src]="item.imageUrl"/>
                </div>
              </div>
              <div class="flex-grow">
                <h3 class="font-bold text-lg text-white">{{ item.title }}</h3>
                <p class="text-sm text-gray-400">{{ item.author }}</p>
                <p class="text-xs text-primary font-medium mt-1">{{ item.format || 'Format numérique (ePub)' }}</p>
              </div>
              <div class="w-full sm:w-auto flex items-center justify-between sm:justify-end gap-6">
                <div class="flex items-center border border-surface-highlight rounded-md">
                  <button 
                    (click)="decrementQuantity(item.id)"
                    class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white transition-colors"
                    [disabled]="item.quantity <= 1">
                    <span class="material-symbols-outlined">remove</span>
                  </button>
                  <span class="w-8 text-center text-white font-medium">{{ item.quantity }}</span>
                  <button 
                    (click)="incrementQuantity(item.id)"
                    class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white transition-colors">
                    <span class="material-symbols-outlined">add</span>
                  </button>
                </div>
                <p class="text-lg font-bold text-white w-40 text-right">{{ formatPrice(item.price, (selectedCurrency$ | async) || 'XOF') }}</p>
                <button 
                  (click)="removeItem(item.id)"
                  class="text-gray-500 hover:text-red-500 transition-colors">
                  <span class="material-symbols-outlined">delete</span>
                </button>
              </div>
            </div>
          </div>

          <div *ngIf="(items$ | async) && (items$ | async)!.length > 0" class="mt-8">
            <a [routerLink]="['/shop']" class="text-primary hover:underline flex items-center gap-2">
              <span class="material-symbols-outlined">arrow_back</span>
              Continuer mes achats
            </a>
          </div>
        </div>
<div class="lg:col-span-1">
          <div class="bg-surface-dark border border-surface-highlight rounded-2xl p-6 lg:p-8 sticky top-24" *ngIf="(items$ | async) && (items$ | async)!.length > 0">
            <h2 class="text-2xl font-bold text-white mb-6">Résumé de la commande</h2>
            <div class="space-y-4">
              <div class="flex justify-between text-gray-300">
                <span>Sous-total</span>
                <span class="font-medium">{{ formatPrice((subtotal$ | async) || 0, (selectedCurrency$ | async) || 'XOF') }}</span>
              </div>
              <div class="flex justify-between text-gray-300">
                <span>TVA (20%)</span>
                <span class="font-medium">{{ formatPrice((tax$ | async) || 0, (selectedCurrency$ | async) || 'XOF') }}</span>
              </div>
              <div class="border-t border-surface-highlight my-4"></div>
              <div class="flex justify-between text-white text-xl font-bold">
                <span>Total</span>
                <span>{{ formatPrice((finalTotal$ | async) || 0, (selectedCurrency$ | async) || 'XOF') }}</span>
              </div>
            </div>
            <div class="mt-8">
              <label class="block text-sm font-medium text-gray-300 mb-2" for="promo-code">Code promotionnel</label>
              <div class="flex flex-col gap-2">
                <input 
                  #promoInput
                  (input)="promoCode = promoInput.value"
                  [value]="promoCode"
                  class="flex-grow bg-surface-highlight border border-[#2E2419] rounded-lg px-4 py-2 text-white placeholder:text-gray-500 focus:border-primary focus:ring-primary/50" 
                  id="promo-code" 
                  placeholder="Entrez votre code" 
                  type="text"/>
                <button 
                  (click)="applyPromoCode()"
                  class="px-4 py-2 rounded-lg border border-[#2E2419] text-white font-semibold hover:bg-surface-highlight transition-colors">
                  Appliquer
                </button>
              </div>
            </div>
            <div class="mt-10">
              <button 
                (click)="proceedToCheckout()"
                class="w-full bg-primary text-background-dark font-bold text-lg py-4 rounded-xl hover:bg-opacity-90 transition-all duration-300 transform hover:scale-[1.02] shadow-[0_0_20px_-5px_rgba(255,159,28,0.5)] flex items-center justify-center gap-2">
                <span class="material-symbols-outlined">lock</span>
                Passer la commande
              </button>
              <p class="text-xs text-gray-500 text-center mt-4">Paiement 100% sécurisé.</p>
            </div>
          </div>
        </div>
</div>
</div>
</main>
  <app-footer></app-footer>
</div>
